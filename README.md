# NOVA_LLM

Code for the paper:

**Beyond the binary classification paradigms: Large language models assisted Nutritional Integrity Index reveal hidden heterogeneity in ultra-processed food health impacts**

This repository contains the code to (i) generate an LLM-derived **Nutritional Integrity Index (NII)** from nutrient profiles and (ii) train an ML **proxy model** that predicts NII from nutrients, enabling large-scale scoring and mechanistic interpretability (e.g., SHAP).

> ⚠️ Security note: do **NOT** commit any API keys. Use environment variables (see below).

---

## Project overview

### What this code does
1. **LLM scoring (observed NII)**  
   Uses a structured prompt (see `prompt.docx`) to let an LLM assign an NII score and rationale from nutrient inputs.

2. **Proxy modeling (predicted NII)**  
   Trains multiple regression models (e.g., Gradient Boosting, LightGBM, XGBoost, Random Forest, SVR, Ridge, Lasso) to predict NII from nutrients.

3. **Evaluation & visualization**  
   Produces model comparison figures (R² / RMSE / MAE), prediction-vs-actual plots, residual diagnostics, and interpretability plots (SHAP dependence and interaction heatmap).

---

## Repository structure

- `data/`  
  Input datasets (nutrient tables, metadata, etc.).  
  > You may need to place external datasets here (depending on your data availability/licensing).

- `results/`  
  Outputs generated by the pipeline (tables, figures, reports).

- `results/proxy_model_results/` (example outputs)
  - `model_comparison.png` / `model_ranking_table.png`
  - `best_model_detailed_analysis.png`
  - `shap_dependence_*.png`
  - `shap_interaction_matrix.png` / `shap_interaction_matrix.csv`
  - `validation_report.json`, `model_comparison_results.json`

- `src/`  
  Core scripts (data validation, LLM scoring, proxy model training, analysis/plotting).

- `main.py`  
  Entry point for running the workflow (recommended: `python main.py --help`).

- `prompt.docx`  
  Prompt template used for LLM-based nutritional assessment / NII generation.

- `requirements.txt` / `pyproject.toml`  
  Python environment specification.

---

## Installation

### 1) Create an environment
```bash
python -m venv .venv
source .venv/bin/activate   # macOS/Linux
# .venv\Scripts\activate    # Windows
